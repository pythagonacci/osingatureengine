name: fastapi@0.115
version: "1.0"
language: python
requires: ["core@1"]
telemetry_tag: fastapi
rules:
  - id: fastapi.router.get
    effect_kind: http.route
    provider: fastapi
    family: router
    confidence: 0.9
    patterns:
      - language: python
        kind: call
        callee: "router.get"
        arg_count_min: 1
    fields:
      - { name: method, source: literal, value_expr: "GET" }
      - { name: path,   source: arg, index: 0 }
  - id: fastapi.app.post
    effect_kind: http.route
    provider: fastapi
    family: app
    confidence: 0.9
    patterns:
      - { language: python, kind: call, callee: "app.post", arg_count_min: 1 }
    fields:
      - { name: method, source: literal, value_expr: "POST" }
      - { name: path,   source: arg, index: 0 }
  - id: fastapi.raw_sql
    effect_kind: db.sql
    provider: python
    family: execute
    confidence: 0.8
    patterns:
      - { language: python, kind: call, callee: "session.execute", arg_count_min: 1 }
    fields:
      - { name: sql, source: arg, index: 0 }
