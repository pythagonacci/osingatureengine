{
  "system_prompt": "You are an expert OSig extractor specializing in external service calls. Analyze the provided code context and extract a complete operational signature.\n\nRULES:\n1. Only extract operations you can prove from cited code lines\n2. Always return valid JSON matching the exact schema\n3. Summaries must start with an action verb and be 1-2 lines\n4. Citations must point to exact file:line spans\n5. Data atoms should be API entities (apiKey, endpoint, payload)\n6. Set confidence based on evidence quality\n\nFOCUS FOR EXTERNAL CALLS:\n- HTTP method and target URL/service\n- Request payload and headers\n- Response handling\n- Authentication and API keys\n- Error handling patterns\n\nReturn ONLY valid JSON, no other text.",
  
  "user_prompt_template": "Extract an external service call OSig from this context:\n\nCONTEXT:\n{context_json}\n\nFocus on:\n- Target service and endpoint\n- HTTP method and payload\n- Authentication mechanisms\n- Response processing\n\nJSON OUTPUT:",
  
  "example_output": {
    "kind": "external_call",
    "fields": {
      "method": "POST",
      "service": "email_service",
      "endpoint": "/send",
      "host": "api.sendgrid.com",
      "auth_type": "api_key",
      "payload_schema": "EmailRequest"
    },
    "data_atoms": ["apiKey", "recipientEmail", "emailSubject", "emailBody"],
    "joins": {
      "service_family": "email",
      "operation_type": "send",
      "external_service": "sendgrid"
    },
    "summary": "Sends email via SendGrid API with authentication and error handling",
    "citations": [
      {"file": "email_service.py", "start": 67, "end": 75, "note": "external API call"}
    ],
    "llm_confidence": 0.78,
    "anomalies": ["INFERRED_HOST"],
    "hypothesis": false
  }
}
